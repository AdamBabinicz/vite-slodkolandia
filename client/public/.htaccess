Options -Indexes
AddDefaultCharset utf-8
RewriteEngine On

# Przekierowanie Z WWW na BEZ WWW (jeśli SŁODKOLANDIA ma być bez www)
# ZMIEŃ 'slodkolandia.cba.pl' na swoją domenę!
RewriteCond %{HTTP_HOST} ^www\.slodkolandia.cba\.pl [NC]
RewriteRule ^(.*)$ https://slodkolandia.cba.pl/$1 [L,R=301]

# Przekierowanie na HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

<IfModule mod_headers.c>
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set Referrer-Policy "strict-origin-when-cross-origin"
    # Header set Permissions-Policy "geolocation=(),midi=(),sync-xhr=(),microphone=(),camera=(),magnetometer=(),gyroscope=(),fullscreen=(self),payment=()" # Opcjonalnie, jeśli działa
    <FilesMatch "\.(ico|jpe?g|png|gif|swf|svg|avif|webp|mp4|webm|woff2?|ttf|otf|css|js|webmanifest)$">
        Header set Cache-Control "public, max-age=31536000, immutable"
        # Header set Access-Control-Allow-Origin "*" # Zazwyczaj niepotrzebne dla zasobów z tej samej domeny
    </FilesMatch>
    <FilesMatch "^index\.html$">
        Header set Cache-Control "no-cache, must-revalidate"
    </FilesMatch>
    Header append Vary "Accept-Encoding"
</IfModule>

# Jeśli masz jakieś stare URL-e do przekierowania na nowe ścieżki SPA dla SŁODKOLANDII,
# umieść je TUTAJ, przed regułami SPA, np.:
# RewriteRule ^stary-link-slodkolandia/?$ /nowa-sciezka-oferta [L,R=301,NC]

# Reguły dla aplikacji jednostronicowej (SPA)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
    AddOutputFilterByType DEFLATE image/svg+xml
    AddOutputFilterByType DEFLATE font/ttf font/otf font/woff font/woff2
</IfModule>

AddType image/avif .avif
AddType image/webp .webp

# Proste blokowanie niektórych botów (możesz rozbudować, jeśli potrzebujesz)
RewriteCond %{HTTP_USER_AGENT} ^BlackWidow [NC,OR]
RewriteCond %{HTTP_USER_AGENT} ^HTTrack [NC]
RewriteRule ^.* - [F,L]

# Zabezpieczenie plików konfiguracyjnych
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|conf|config|cnf|sql|bak|backup|swp|~$)$">
  Require all denied
</FilesMatch>